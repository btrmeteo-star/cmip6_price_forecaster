<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CMIP6 å†œäº§å“ä»·æ ¼é¢„æµ‹</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
    h1 { color: #2c3e50; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
    button { margin-top: 20px; padding: 10px 20px; background: #3498db; color: white; border: none; cursor: pointer; }
    button:hover { background: #2980b9; }
    #result { margin-top: 20px; padding: 15px; background: #f9f9f9; border-left: 4px solid #3498db; display: none; }
  </style>
</head>
<body>
  <h1>ğŸŒ¾ CMIP6 å†œäº§å“ä»·æ ¼é¢„æµ‹</h1>
  <p>è¾“å…¥æ°”å€™å’Œå†å²ä»·æ ¼æ•°æ®ï¼Œé¢„æµ‹ä¸‹ä¸€å‘¨æœŸä»·æ ¼ã€‚</p>

  <label for="crop">ä½œç‰© (Crop)</label>
  <select id="crop">
    <option value="rice">æ°´ç¨» (Rice)</option>
    <option value="wheat">å°éº¦ (Wheat)</option>
  </select>

  <!-- ç‰¹å¾è¾“å…¥ -->
  <label>é™æ°´ (pr, mm/day)</label>
  <input type="number" step="0.1" id="pr" value="4.5">

  <label>å‰ä¸€æœŸé™æ°´ (pr_lag1)</label>
  <input type="number" step="0.1" id="pr_lag1" value="4.2">

  <label>å‰ä¸¤æœŸé™æ°´ (pr_lag2)</label>
  <input type="number" step="0.1" id="pr_lag2" value="4.7">

  <label>é™æ°´æ ‡å‡†å·® (pr_std)</label>
  <input type="number" step="0.01" id="pr_std" value="0.25">

  <label>ä¸ŠæœŸä»·æ ¼ (price_lag1)</label>
  <input type="number" step="0.1" id="price_lag1" value="260.0">

  <label>ä¸Šä¸¤æœŸä»·æ ¼ (price_lag2)</label>
  <input type="number" step="0.1" id="price_lag2" value="258.5">

  <label>æœ€é«˜æ¸© (tasmax, Â°C)</label>
  <input type="number" step="0.1" id="tasmax" value="32.1">

  <label>å‰ä¸€æœŸæœ€é«˜æ¸© (tasmax_lag1)</label>
  <input type="number" step="0.1" id="tasmax_lag1" value="31.8">

  <label>å‰ä¸¤æœŸæœ€é«˜æ¸© (tasmax_lag2)</label>
  <input type="number" step="0.1" id="tasmax_lag2" value="32.0">

  <label>æœ€é«˜æ¸©å‡å€¼ (tasmax_mean)</label>
  <input type="number" step="0.1" id="tasmax_mean" value="32.0">

  <button onclick="predict()">é¢„æµ‹ä»·æ ¼</button>

  <div id="result"></div>

  <script>
    // ğŸ”§ æ›¿æ¢ä¸ºä½ çš„å®é™… API åœ°å€ï¼ˆå¦‚æœæ˜¯æœ¬åœ°å¼€å‘ï¼Œç”¨ http://localhost:8080ï¼‰
    const API_BASE = "https://verbose-space-waffle-7v6wqw4wxp5hrrw6-8080.app.github.dev";

    async function predict() {
      const crop = document.getElementById("crop").value;
      const features = {
        pr: parseFloat(document.getElementById("pr").value),
        pr_lag1: parseFloat(document.getElementById("pr_lag1").value),
        pr_lag2: parseFloat(document.getElementById("pr_lag2").value),
        pr_std: parseFloat(document.getElementById("pr_std").value),
        price_lag1: parseFloat(document.getElementById("price_lag1").value),
        price_lag2: parseFloat(document.getElementById("price_lag2").value),
        tasmax: parseFloat(document.getElementById("tasmax").value),
        tasmax_lag1: parseFloat(document.getElementById("tasmax_lag1").value),
        tasmax_lag2: parseFloat(document.getElementById("tasmax_lag2").value),
        tasmax_mean: parseFloat(document.getElementById("tasmax_mean").value),
      };

      try {
        const response = await fetch(`${API_BASE}/predict`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ crop, features })
        });

        const data = await response.json();
        const resultDiv = document.getElementById("result");
        if (response.ok) {
          resultDiv.innerHTML = `
            <strong>é¢„æµ‹ç»“æœ</strong><br>
            ä½œç‰©: ${data.crop}<br>
            é¢„æµ‹ä»·æ ¼: <span style="color:#e74c3c;font-weight:bold">${data.predicted_price.toFixed(2)}</span><br>
            çŠ¶æ€: ${data.status}
          `;
        } else {
          resultDiv.innerHTML = `<strong>é”™è¯¯:</strong> ${JSON.stringify(data)}`;
        }
        resultDiv.style.display = "block";
      } catch (error) {
        document.getElementById("result").innerHTML = `<strong>è¯·æ±‚å¤±è´¥:</strong> ${error.message}`;
        document.getElementById("result").style.display = "block";
      }
    }
  </script>
</body>
</html>